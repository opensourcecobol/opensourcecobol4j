AT_SETUP([move sign-leading-separate to comp3])

AT_DATA([prog.cbl], [
       IDENTIFICATION              DIVISION.
      ******************************************************************
       PROGRAM-ID.                 prog.                               
       ENVIRONMENT            DIVISION.                                
       DATA                        DIVISION. 
       FILE                   SECTION. 
       WORKING-STORAGE             SECTION.
       01  P-NUM1-0 PIC S9(10) VALUE +15.
       01  P-NUM1-1 PIC S9(10) SIGN LEADING SEPARATE VALUE +15.
       01  P-NUM1-2 PIC S9(10) SIGN LEADING VALUE +15.
       01  P-NUM1-3 PIC S9(10) SIGN TRAILING SEPARATE VALUE +15.
       01  P-NUM1-4 PIC S9(10) SIGN TRAILING VALUE +15.

       01  P-NUM2-0 PIC S9(12) VALUE +15.
       01  P-NUM2-1 PIC S9(12) SIGN LEADING SEPARATE VALUE +15.
       01  P-NUM2-2 PIC S9(12) SIGN LEADING VALUE +15.
       01  P-NUM2-3 PIC S9(12) SIGN TRAILING SEPARATE VALUE +15.
       01  P-NUM2-4 PIC S9(12) SIGN TRAILING VALUE +15.

       01  P-NUM3-0 PIC S9(13) VALUE +15.
       01  P-NUM3-1 PIC S9(13) SIGN LEADING SEPARATE VALUE +15.
       01  P-NUM3-2 PIC S9(13) SIGN LEADING VALUE +15.
       01  P-NUM3-3 PIC S9(13) SIGN TRAILING SEPARATE VALUE +15.
       01  P-NUM3-4 PIC S9(13) SIGN TRAILING VALUE +15.

       01  P-NUM4-0 PIC S9(14) VALUE +15.
       01  P-NUM4-1 PIC S9(14) SIGN LEADING SEPARATE VALUE +15.
       01  P-NUM4-2 PIC S9(14) SIGN LEADING VALUE +15.
       01  P-NUM4-3 PIC S9(14) SIGN TRAILING SEPARATE VALUE +15.
       01  P-NUM4-4 PIC S9(14) SIGN TRAILING VALUE +15.

       01  P-NUM5-0 PIC S9(15) VALUE +15.
       01  P-NUM5-1 PIC S9(15) SIGN LEADING SEPARATE VALUE +15.
       01  P-NUM5-2 PIC S9(15) SIGN LEADING VALUE +15.
       01  P-NUM5-3 PIC S9(15) SIGN TRAILING SEPARATE VALUE +15.
       01  P-NUM5-4 PIC S9(15) SIGN TRAILING VALUE +15.

       01  P-PACKED-DATA-1             PIC S9(13)  COMP-3.
       01  P-PACKED-DATA-2             PIC S9(14)  COMP-3.

       01  N-NUM1-0 PIC S9(10) VALUE -15.
       01  N-NUM1-1 PIC S9(10) SIGN LEADING SEPARATE VALUE -15.
       01  N-NUM1-2 PIC S9(10) SIGN LEADING VALUE -15.
       01  N-NUM1-3 PIC S9(10) SIGN TRAILING SEPARATE VALUE -15.
       01  N-NUM1-4 PIC S9(10) SIGN TRAILING VALUE -15.

       01  N-NUM2-0 PIC S9(12) VALUE -15.
       01  N-NUM2-1 PIC S9(12) SIGN LEADING SEPARATE VALUE -15.
       01  N-NUM2-2 PIC S9(12) SIGN LEADING VALUE -15.
       01  N-NUM2-3 PIC S9(12) SIGN TRAILING SEPARATE VALUE -15.
       01  N-NUM2-4 PIC S9(12) SIGN TRAILING VALUE -15.

       01  N-NUM3-0 PIC S9(13) VALUE -15.
       01  N-NUM3-1 PIC S9(13) SIGN LEADING SEPARATE VALUE -15.
       01  N-NUM3-2 PIC S9(13) SIGN LEADING VALUE -15.
       01  N-NUM3-3 PIC S9(13) SIGN TRAILING SEPARATE VALUE -15.
       01  N-NUM3-4 PIC S9(13) SIGN TRAILING VALUE -15.

       01  N-NUM4-0 PIC S9(14) VALUE -15.
       01  N-NUM4-1 PIC S9(14) SIGN LEADING SEPARATE VALUE -15.
       01  N-NUM4-2 PIC S9(14) SIGN LEADING VALUE -15.
       01  N-NUM4-3 PIC S9(14) SIGN TRAILING SEPARATE VALUE -15.
       01  N-NUM4-4 PIC S9(14) SIGN TRAILING VALUE -15.

       01  N-NUM5-0 PIC S9(15) VALUE -15.
       01  N-NUM5-1 PIC S9(15) SIGN LEADING SEPARATE VALUE -15.
       01  N-NUM5-2 PIC S9(15) SIGN LEADING VALUE -15.
       01  N-NUM5-3 PIC S9(15) SIGN TRAILING SEPARATE VALUE -15.
       01  N-NUM5-4 PIC S9(15) SIGN TRAILING VALUE -15.

       01  N-PACKED-DATA-1             PIC S9(13)  COMP-3.
       01  N-PACKED-DATA-2             PIC S9(14)  COMP-3.

       PROCEDURE                   DIVISION.

       MOVE P-NUM1-0 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM1-1 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM1-2 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM1-3 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM1-4 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.
      *****************************
       MOVE P-NUM2-0 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM2-1 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM2-2 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM2-3 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM2-4 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.
      *****************************
       MOVE P-NUM3-0 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM3-1 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM3-2 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM3-3 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM3-4 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.
      *****************************
       MOVE P-NUM4-0 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM4-1 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM4-2 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM4-3 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM4-4 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.
      *****************************
       MOVE P-NUM5-0 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM5-1 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM5-2 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM5-3 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.

       MOVE P-NUM5-4 TO P-PACKED-DATA-1.
       DISPLAY P-PACKED-DATA-1.
      *****************************
      *****************************
       MOVE P-NUM1-0 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM1-1 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM1-2 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM1-3 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM1-4 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.
      *****************************
       MOVE P-NUM2-0 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM2-1 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM2-2 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM2-3 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM2-4 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.
      *****************************
       MOVE P-NUM3-0 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM3-1 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM3-2 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM3-3 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM3-4 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.
      *****************************
       MOVE P-NUM4-0 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM4-1 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM4-2 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM4-3 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM4-4 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.
      *****************************
       MOVE P-NUM5-0 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM5-1 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM5-2 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM5-3 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.

       MOVE P-NUM5-4 TO P-PACKED-DATA-2.
       DISPLAY P-PACKED-DATA-2.
      *****************************
       DISPLAY "***************"
      *****************************
       MOVE N-NUM1-0 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM1-1 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM1-2 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM1-3 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM1-4 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.
      *****************************
       MOVE N-NUM2-0 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM2-1 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM2-2 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM2-3 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM2-4 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.
      *****************************
       MOVE N-NUM3-0 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM3-1 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM3-2 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM3-3 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM3-4 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.
      *****************************
       MOVE N-NUM4-0 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM4-1 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM4-2 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM4-3 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM4-4 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.
      *****************************
       MOVE N-NUM5-0 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM5-1 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM5-2 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM5-3 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.

       MOVE N-NUM5-4 TO N-PACKED-DATA-1.
       DISPLAY N-PACKED-DATA-1.
      *****************************
      *****************************
       MOVE N-NUM1-0 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM1-1 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM1-2 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM1-3 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM1-4 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.
      *****************************
       MOVE N-NUM2-0 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM2-1 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM2-2 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM2-3 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM2-4 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.
      *****************************
       MOVE N-NUM3-0 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM3-1 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM3-2 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM3-3 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM3-4 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.
      *****************************
       MOVE N-NUM4-0 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM4-1 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM4-2 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM4-3 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM4-4 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.
      *****************************
       MOVE N-NUM5-0 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM5-1 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM5-2 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM5-3 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.

       MOVE N-NUM5-4 TO N-PACKED-DATA-2.
       DISPLAY N-PACKED-DATA-2.
      *****************************
])

AT_CHECK([cobj prog.cbl])
AT_CHECK([java prog], [0],
[+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+0000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
+00000000000015
***************
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-0000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
-00000000000015
])

AT_CLEANUP
