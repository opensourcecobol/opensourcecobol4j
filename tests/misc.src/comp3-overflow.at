AT_SETUP([COMP-3 overflow])

AT_DATA([prog.cbl], [
       IDENTIFICATION DIVISION.
       PROGRAM-ID.            prog.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 WK-TEST1 PIC S9(13) COMP-3.
       01 WK-TEST2 PIC S9(13) COMP-3.
       01 CT-0     PIC S9(13) VALUE ZERO.
       01 CT-BIG   PIC S9(13) VALUE 8121068907050.

       01 S-1 PIC S9(1) COMP-3.
       01 U-1 PIC 9(1) COMP-3.

       01 S-2 PIC S9(2) COMP-3.
       01 U-2 PIC 9(2) COMP-3.

       01 S-9 PIC S9(9) COMP-3.
       01 U-9 PIC 9(9) COMP-3.

       01 S-10 PIC S9(10) COMP-3.
       01 U-10 PIC 9(10) COMP-3.

       01 S-15 PIC S9(15) COMP-3.
       01 U-15 PIC 9(15) COMP-3.

       01 S-16 PIC S9(16) COMP-3.
       01 U-16 PIC 9(16) COMP-3.
       PROCEDURE DIVISION.
           MOVE CT-0 TO WK-TEST1.
           MOVE CT-BIG TO WK-TEST2.

           COMPUTE WK-TEST1 = WK-TEST1 - WK-TEST2.
           DISPLAY WK-TEST1.
           COMPUTE WK-TEST1 = WK-TEST1 - WK-TEST2.
           DISPLAY WK-TEST1.

           COMPUTE S-1 = 9 + 1. DISPLAY S-1.
           COMPUTE S-1 = 9 + 12. DISPLAY S-1.
           COMPUTE S-1 = 9 + 103. DISPLAY S-1.
           COMPUTE S-1 = 9 + 10.
           DISPLAY S-1.

           COMPUTE S-1 = -9 - 1. DISPLAY S-1.
           COMPUTE S-1 = -9 - 12. DISPLAY S-1.
           COMPUTE S-1 = -9 - 103. DISPLAY S-1.
           COMPUTE S-1 = -9 - 10.
           DISPLAY S-1.

           COMPUTE U-1 = 9 + 1. DISPLAY U-1.
           COMPUTE U-1 = 9 + 12. DISPLAY U-1.
           COMPUTE U-1 = 9 + 103. DISPLAY U-1.
           COMPUTE U-1 = 9 + 10.
           DISPLAY U-1.

           COMPUTE S-2 = 99 + 1.     DISPLAY S-2.
           COMPUTE S-2 = 99 + 102.   DISPLAY S-2.
           COMPUTE S-2 = 99 + 1003.  DISPLAY S-2.
           COMPUTE S-2 = 99 + 100.
           DISPLAY S-2.

           COMPUTE S-2 = -99 - 1.    DISPLAY S-2.
           COMPUTE S-2 = -99 - 102.  DISPLAY S-2.
           COMPUTE S-2 = -99 - 1003. DISPLAY S-2.
           COMPUTE S-2 = -99 - 100.
           DISPLAY S-2.

           COMPUTE U-2 = 99 + 1.     DISPLAY U-2.
           COMPUTE U-2 = 99 + 102.   DISPLAY U-2.
           COMPUTE U-2 = 99 + 1003.  DISPLAY U-2.
           COMPUTE U-2 = 99 + 100.
           DISPLAY U-2.

           COMPUTE S-9 = 999999999 + 1. DISPLAY S-9.
           COMPUTE S-9 = 999999999 + 2. DISPLAY S-9.
           COMPUTE S-9 = 999999999 + 3. DISPLAY S-9.
           COMPUTE S-9 = 999999999 + 1000000000.
           DISPLAY S-9.

           COMPUTE S-9 = -999999999 - 1. DISPLAY S-9.
           COMPUTE S-9 = -999999999 - 2. DISPLAY S-9.
           COMPUTE S-9 = -999999999 - 3. DISPLAY S-9.
           COMPUTE S-9 = -999999999 - 1000000000.
           DISPLAY S-9.

           COMPUTE U-9 = 999999999 + 1.  DISPLAY U-9.
           COMPUTE U-9 = 999999999 + 2.  DISPLAY U-9.
           COMPUTE U-9 = 999999999 + 3.  DISPLAY U-9.
           COMPUTE U-9 = 999999999 + 1000000000.
           DISPLAY U-9.

           COMPUTE S-10 = 9999999999 + 1. DISPLAY S-10.
           COMPUTE S-10 = 9999999999 + 2. DISPLAY S-10.
           COMPUTE S-10 = 9999999999 + 3. DISPLAY S-10.
           COMPUTE S-10 = 9999999999 + 10000000000.
           DISPLAY S-10.

           COMPUTE S-10 = -9999999999 - 1. DISPLAY S-10.
           COMPUTE S-10 = -9999999999 - 2. DISPLAY S-10.
           COMPUTE S-10 = -9999999999 - 3. DISPLAY S-10.
           COMPUTE S-10 = -9999999999 - 10000000000.
           DISPLAY S-10.

           COMPUTE U-10 = 9999999999 + 1.  DISPLAY U-10.
           COMPUTE U-10 = 9999999999 + 2.  DISPLAY U-10.
           COMPUTE U-10 = 9999999999 + 3.  DISPLAY U-10.
           COMPUTE U-10 = 9999999999 + 10000000000.
           DISPLAY U-10.

           COMPUTE S-15 = 999999999999999 + 1. DISPLAY S-15.
           COMPUTE S-15 = 999999999999999 + 2. DISPLAY S-15.
           COMPUTE S-15 = 999999999999999 + 3. DISPLAY S-15.
           COMPUTE S-15 = 999999999999999 + 1000000000000000.
           DISPLAY S-15.

           COMPUTE S-15 = -999999999999999 - 1. DISPLAY S-15.
           COMPUTE S-15 = -999999999999999 - 2. DISPLAY S-15.
           COMPUTE S-15 = -999999999999999 - 3. DISPLAY S-15.
           COMPUTE S-15 = -999999999999999 - 1000000000000000.
           DISPLAY S-15.

           COMPUTE U-15 = 999999999999999 + 1.  DISPLAY U-15.
           COMPUTE U-15 = 999999999999999 + 2.  DISPLAY U-15.
           COMPUTE U-15 = 999999999999999 + 3.  DISPLAY U-15.
           COMPUTE U-15 = 999999999999999 + 1000000000000000.
           DISPLAY U-15.

           COMPUTE S-16 = 9999999999999999 + 1. DISPLAY S-16.
           COMPUTE S-16 = 9999999999999999 + 2. DISPLAY S-16.
           COMPUTE S-16 = 9999999999999999 + 3. DISPLAY S-16.
           COMPUTE S-16 = 9999999999999999 + 10000000000000000.
           DISPLAY S-16.

           COMPUTE S-16 = -9999999999999999 - 1. DISPLAY S-16.
           COMPUTE S-16 = -9999999999999999 - 2. DISPLAY S-16.
           COMPUTE S-16 = -9999999999999999 - 3. DISPLAY S-16.
           COMPUTE S-16 = -9999999999999999 - 10000000000000000.
           DISPLAY S-16.

           COMPUTE U-16 = 9999999999999999 + 1.  DISPLAY U-16.
           COMPUTE U-16 = 9999999999999999 + 2.  DISPLAY U-16.
           COMPUTE U-16 = 9999999999999999 + 3.  DISPLAY U-16.
           COMPUTE U-16 = 9999999999999999 + 10000000000000000.
           DISPLAY U-16.
])

AT_CHECK([${COBJ} prog.cbl])
AT_CHECK([java prog], [0],
[-8121068907050
-6242137814100
+0
+1
+2
+9
-0
-1
-2
-9
0
1
2
9
+00
+01
+02
+99
-00
-01
-02
-99
00
01
02
99
+000000000
+000000001
+000000002
+999999999
-000000000
-000000001
-000000002
-999999999
000000000
000000001
000000002
999999999
+0000000000
+0000000001
+0000000002
+9999999999
-0000000000
-0000000001
-0000000002
-9999999999
0000000000
0000000001
0000000002
9999999999
+000000000000000
+000000000000001
+000000000000002
+999999999999999
-000000000000000
-000000000000001
-000000000000002
-999999999999999
000000000000000
000000000000001
000000000000002
999999999999999
+0000000000000000
+0000000000000001
+0000000000000002
+9999999999999999
-0000000000000000
-0000000000000001
-0000000000000002
-9999999999999999
0000000000000000
0000000000000001
0000000000000002
9999999999999999
])

AT_CLEANUP
