AT_SETUP([misc])

AT_CHECK([${COBJ_IDX}], [0],
[cobj-idx - Utility tool to handle a indexed file of opensource COBOL 4J

Usage:

cobj-idx info <indexed-file>   - Show information of the indexed file.
cobj-idx load <indexed-file>   - Load data inputted from stdin to the indexed file.
                                 The format of the input data is line-sequential of COBOL.
cobj-idx unload <indexed-file> - Write records stored in the indexed file to stdout.
                                 The format of the output data is line-sequential of COBOL.

Options:

-h --help                      - Print this message.
-n, --new                      - Delete all data before inserting new data.
-v, --version                  - Print the version of cobj-idx. 
])

AT_CHECK([${COBJ_IDX} --version | grep -vE '@<:@0-9@:>@+\.@<:@0-9@:>@+\.@<:@0-9@:>@+'], [1])

AT_CHECK([${COBJ_IDX} info], [1], [],
[error: no indexed file is specified.
])

AT_CHECK([${COBJ_IDX} load], [1], [],
[error: no indexed file is specified.
])
AT_CHECK([${COBJ_IDX} unload], [1], [],
[error: no indexed file is specified.
])

AT_CHECK([${COBJ_IDX} info file1 file2], [1], [],
[error: too many indexed files are specified.
])
AT_CHECK([${COBJ_IDX} load file1 file2], [1], [],
[error: too many indexed files are specified.
])
AT_CHECK([${COBJ_IDX} unload], [1], [],
[error: no indexed file is specified.
])

AT_CLEANUP
