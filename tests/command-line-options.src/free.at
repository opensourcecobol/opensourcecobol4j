AT_SETUP([-free and -free_1col_aster])

AT_DATA([prog.cbl], [
IDENTIFICATION              DIVISION.
PROGRAM-ID.                 prog.
DATA                        DIVISION.
WORKING-STORAGE             SECTION.
PROCEDURE                   DIVISION.
    DISPLAY "HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO".
])

AT_CHECK([${COBJ} -free prog.cbl])
AT_CHECK([${RUN_MODULE} prog], [0],
[HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO
])

AT_DATA([prog2.cbl], [
*aaaa
IDENTIFICATION              DIVISION.
PROGRAM-ID.                 prog2.
DATA                        DIVISION.
WORKING-STORAGE             SECTION.
PROCEDURE                   DIVISION.
    DISPLAY "HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO".
    DISPLAY "HELLO
*world world".
WORLD".
])

AT_CHECK([${COBJ} -free_1col_aster prog2.cbl])
AT_CHECK([${RUN_MODULE} prog2], [0],
[HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO HELLO
HELLO

WORLD
])

AT_CLEANUP